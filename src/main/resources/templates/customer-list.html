<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <title>Customer Manager</title>
</head>
<body>
<div align="center">
    <h1>Customer List</h1>
    <br/><br/>

    <!-- Show link only if authenticated -->
    <div sec:authorize="isAuthenticated()">
        <a th:href="@{/}"
           style="font-size: 18px; padding: 10px 25px; border: 1px solid #000; border-radius: 5px; text-decoration: none;">
            Back to Home
        </a>
    </div>

    <table border="1" cellpadding="10">
        <thead>
        <tr>
            <!--
            You are creating a table here, where the header will be the
            Customer details and then the other rows will be filled by
            the data that you send back in the Model object.
            -->
            <th>Customer ID</th>
            <th>Full Name</th>
            <th>Email Address</th>
            <th>Age</th>
            <th>Address</th>
            <th>Car</th>
            <th>Actions</th>
        </tr>
        </thead>
        <!--
         Now that your headers are defined, you can reference the
         key-value pair "customerList" that you added to the model above.
         Thymeleaf will loop over each customer and extract the attributes
         to match your column names.
        -->
        <tbody>
        <tr th:each="customer : ${customerList}">
            <td th:text="${customer.id}">Customer ID</td>
            <td th:text="${customer.fullName}">Full Name</td>
            <td th:text="${customer.emailAddress}">Email Address</td>
            <td th:text="${customer.age}">Age</td>
            <td th:text="${customer.address}">Address</td>
            <td><!-- actions -->
                <a th:href="@{/new}">Add New Customer</a>
                <a th:href="@{'/edit/' + ${customer.id}}">Edit</a>
                <a th:href="@{'/delete/' + ${customer.id}}">Delete</a>
                <a th:text="${(customer.rentalCar == null) ? 'Assign Car' : ''}"
                   th:href="@{'/cars/assign/' + ${customer.id}}"></a>
                <a th:text="${(customer.rentalCar != null) ? 'Remove Car' : ''}"
                   th:href="${(customer.rentalCar != null) ? '/remove/' + customer.rentalCar.getId() : ''}"></a>
            </td>
        </tr>
        </tbody>
    </table>

    <h1>Batch Job</h1>
    <br/><br/>
    <!-- Feedback message section -->
    <div th:if="${message}">
        <strong th:text="${message}"></strong>
        <br/><br/>
    </div>
    <!-- Start Job Button Form -->
    <form th:action="@{/startJob}" method="post">
        <button type="submit" style="padding: 10px 30px; font-size: 18px;">Start Batch Job</button>
    </form>

    <h2>Batch Job History</h2>
    <table border="1" cellpadding="10" style="margin: auto;">
        <thead>
        <tr>
            <th>Execution ID</th>
            <th>Status</th>
            <th>Exit Code</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="exec : ${jobExecutions}">
            <td th:text="${exec.id}">Execution ID</td>
            <td th:text="${exec.status}">Status</td>
            <td th:text="${exec.exitStatus.exitCode}">Exit Code</td>
        </tr>
        </tbody>
    </table>


</div>
</body>
</html>
